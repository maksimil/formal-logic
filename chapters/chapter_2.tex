\part{Вывод теорем}

\section{Формальная система}

Совокупность правил называется {\it формальной системой}, если выполняются следующие
условия:
\begin{enumerate}
	\item{}Задан {\it алфавит} для составления {\it выражений}.
	\item{}Определено понятия {\it формулы}.
	\item{}Задана совокупность формул, называемых {\it аксиомами}.
	\item{}Заданы {\it правила вывода теорем}.
\end{enumerate}

Если формула $T$ выводима из формул $A_1,A_2,...,A_{n}$ за один шаг (одно применение
правил вывода), то пишут $A_1,A_2,...,A_{n}\vdash T$. Порядок формул
не имеет значения: если $A,B\vdash T$, то и $B,A\vdash T$.
Могут быть и излишние формулы: если $A\vdash T$, то и $A,B\vdash T$.

\newcommand\ruleR{\mathbf{R}}
\newcommand\ruleC{\mathbf{C}}

Рассмотрим следующий пример формальной системы:
\begin{enumerate}
	\item{}Алфавит: $a$, $b$, $c$.
	\item{}Всякое непустое выражение является формулой.
	\item{}Аксиомы: $aab$, $c$.
	\item{}Правила вывода:
	\begin{enumerate}
		\item[($\ruleR$)]{}$A\vdash A'$, если $A'$ можно получить из $A$,
		убрав один символ\footnote{Тогда $aab\vdash ab$ и $ab\vdash b$.}.
		\item[($\ruleC$)]{}$A,B\vdash AB$, если у формул $A$ и $B$ нет
		общих символов\footnote{Тогда $b,c\vdash bc$ и $ac,bb\vdash acbb$.}.
	\end{enumerate}
\end{enumerate}

\newcommand\Sx{\mathcal S}
Возьмём совокупность формул $\Sx$. Пусть
\[
	\Sx\vdash A_1\qquad
	\Sx,A_1\vdash A_2\qquad...\qquad
	\Sx,A_1,A_2,...,A_{n-1}\vdash A_{n}
\]

Тогда пишут $\Sx\to A_{n}$ и говорят, что $A_{n}$ {\it доказуемо} из $\Sx$\footnote{
	Заметим, что $A\vdash B$ подразумевает $A\to B$.
}.
Рассуждения, показывающие доказуемость называются {\it доказательством}.
Если $\Sx$~---~совокупность аксиом и $\Sx\to T$, то $T$ называют
{\it теоремой}.

{\it Теорема:} $abc$

{\it Доказательство:}
$aab\vdash ab$ по правилу $\ruleR$, значит $aab,c\vdash ab$.
$ab,c\vdash abc$ по правилу $\ruleC$, значит $aab,c,ab\vdash abc$.
Тогда $aab,c\to abc$ и $abc$ --- теорема, потому что $aab$ и $c$ --- аксиомы.
\qed\footnote{$\qed$ означает ``что и требовалось доказать''.}

Доказуемость можно показать и с помощью рассуждений в {\it нормальном виде}:
Для доказательства $\Sx\to T$ можно предположить формулы из $\Sx$ и последовательно
увеличивать список выведенных формул, пока не дойдём до $T$.

\pagebreak

Доказательство $abc$ в нормальном виде:
\begin{enumerate}[label=(\arabic*)]
	\item{}Предположим $aab$.\label{exproof:1}
	\item{}Предположим $c$.\label{exproof:2}
	\item{}$ab$ по $\ruleR$, \ref{exproof:1}.\label{exproof:3}
	\item{}$abc$ по $\ruleC$, \ref{exproof:3}, \ref{exproof:2}.
\end{enumerate}

Тогда $aab,c\to abc$.\qed

\textsc{формальная система является просто набором правил и её формулы
	могут не иметь смысла. Они и не будут иметь смысла, пока мы не начнём их
	интерпретировать, то есть придавать им этот смысл.}

В общем случае формальные системы не обращаются с понятиями ``истины'' и ``лжи'',
они обращаются с понятиями ``выводимости''. Но для удобства определим формулу
как {\it истинную}, если она является аксиомой или теоремой\footnote{
	Если $F$ --- истинная формула, то её истинность исходит из
	определения формальной системы, поэтому такие $F$ принято называть тавтологиями.
}.

Важно понимать связь между понятием истины в формальных системах
и эмпиричной истины\footnote{Эмпиризм --- метод познания через ощущение (наблюдение).}.
Физики подбирают аксиомы (постулаты),
из которых выводимы теоремы (законы), соответствующие наблюдениям.
Они подгоняют истину формальной системы к эмпиричной истине.

Математики же
в большинстве областей подгоняют формальную систему так,
чтобы она соответствовала интуитивной логике,
что не всегда получается: понятие ``импликации'' в математике не совпадает
с понятием ``следствия'' интуитивной логики. Следствие
нередко подразумевает причинно-следственную
связь, импликация же такой связи не подразумевает (например, ${p\implies(q\implies p)}$).

\section{Правила вывода}

Сформулируем формальную систему, в которой мы будем работать.
Алфавит будет состоять из букв различиных человеческих языков, символов $\top$,
$\bot$, а также $\lnot$, $\implies$, $\land$, $\lor$. Кванторы и равенство пока
что вводить не будем.

Формулу определим следующим образом: если $A$, $B$ --- формулы, то формулами
являются выражения $\lnot A$, ${A\implies B}$, $A\land B$, $A\lor B$.
$\top$ и $\bot$ также являются формулами\footnote{
	Заметим, что не каждый символ является формулой, в отличие от определения
	формулы в первой главе. Формулой будем называть то, что мы называли
	логическим утверждением.
}.

Для удобства введём понятие {\it шаблона выражения}. Возьмём выражение $P$ и выберем
в нём определённый символ. В выражении $P(x)$ заменим этот символ символом $x$,
в выражении $P(A\land B)$ --- выражением $A\land B$ (возможно понадобится добавить
скобки). $P$ называется {\it шаблоном выражения}, а $x$ и $A\land B$ ---
{\it аргументами} шаблона.
Шаблоны могут иметь несколько аргументов.

Например, обозначим выражение $\xi\land t$ буквой $Q$ и выберем в нём символ $\xi$.
Тогда $Q(A)$ будет обозначать $A\land t$, а $Q(a\lor b)$ --- $(a\lor b)\land t$.
Обычно эта мысль выражается так: $Q(\xi): \xi\land t$.

\newcommand\Px{\mathcal P}
{\it Простой тавтологией} будем называть тавтологию, содержащую только символы
переменных, а также $\top$, $\bot$, $\implies$, $\lnot$, $\land$, $\lor$, причём
допустимые значения для всех переменных --- $\top$ и $\bot$. С ними легче
работать, потому что проверить их на тавтологию достаточно просто. Причём
если $T(\Px)$ --- тавтология, где $\Px$ --- совокупность из $m$ символов
переменных, то $T(\Sx)$ --- формула, где $\Sx$ --- совокупность из $m$ формул.

Например $p\implies p\lor q$ --- простая тавтология, а $A\implies A\lor B$ --- формула,
если $A$ и $B$ --- формулы.

Возьмём $\top$ как аксиому и введём правила вывода:

\newcommand\taut{$\mathcal T$}
\newcommand\axiom{$\mathcal A$}
\newcommand\conj{$\mathcal C$}
\newcommand\implic{$\mathcal I$}
\begin{enumerate}
	\item[(\axiom)]{}$S\vdash A$, где $A$ --- аксиома, $S$ --- любая формула.

	\item[(\taut)]{}$F_1(\Sx),...,F_n(\Sx)\vdash T(\Sx)$,
	если ${[F_1(\Px)\land...\land F_n(\Px)\implies T(\Px)]}$ --- простая тавтология,
	где $F_{1},...,F_{n},T$ --- шаблоны выражений,
	$\Px$~---~совокупность из $m$ символов переменных,
	$\Sx$ --- совокупность из $m$ произвольных формул\footnote{
		Например, возьмём простую тавтологию
		\[
			(p\land (p\implies q))\implies q
		\]

		Обозначим шаблоны.
		\[
			F_1(p,q): p\qquad
			F_2(p,q): p\implies q
		\]
		\[
			T(p,q): q
		\]

		Совокупность $\Px$ содержит $p$ и $q$.
		Совокупность $\Sx$ содержит произвольные формулы $A$ и $B$.
		По \taut{} имеем правило
		\[
			A,[A\implies B]\vdash B
		\]
		для произвольных формул $A$ и $B$.

		Исходя из той же тавтологии также имеем правило
		\[
			A\land[A\implies B]\vdash B
		\]
		для произвольных формул $A$ и $B$.
	}.

	\item[(\implic)]{}${\Gamma\vdash (S\implies T)}$, если $[\Gamma,S\to T]$, где $\Gamma$
	--- совокупность формул.
\end{enumerate}

Правило \axiom{} позволяет проще использовать аксиомы в рассуждениях.
\taut{} позволяет использовать тавтологии в рассуждениях.
\conj{} позволяет объединять несколько утвержедний в одно.
\implic{} позволяет доказывать импликацию.

На данный момент мы ввели 3 ``стрелочки'':
\begin{enumerate}
	\item{}$\vdash$ означает выводимость за 1 шаг.
	\item{}$\to$ означает существование доказательства.
	\item{}$\implies$ --- символ из алфавита формальной системы.
\end{enumerate}

% Заметим, что по правилу \taut{} и тавтологии ${A\iff (A=\top)}$
% существуют правила $A\vdash [A=\top]$ и $[A=\top]\vdash A$,
% значит понятие истины в формальной системе и $\top$ равносильны.

Рассмотрим пример доказательства.

{\it Теорема:} Для формул $A$, $B$ и $C$ справедливо\footnote[][3mm]{
	Уточнение, что $A$, $B$, $C$ --- формулы необходимо, чтобы выражение, которое
	нужно доказать было формулой.

	``Справедливо'' означает ``истинно'', то есть доказуемо из аксиом.
}
\[
	[(A\implies B)\land (A\implies C)]\implies (A\implies B\land C)
\]

{\it Доказательство:}
\begin{enumerate}[label=(\arabic*)]
	\item{}Предположим $(A\implies B)\land (A\implies C)$.\label{exproof:1}

	\item{}Предположим $A$.\label{exproof:2}

	\item{}По \taut{} и тавтологии $(p\land q)\implies p$ имеем
	$p\land q\vdash p$, значит из \ref{exproof:1} можем вывести
	$A\implies B$ и аналогично $A\implies C$.\label{exproof:3}

	\item{}По \taut{} и тавтологии $(p\land (p\implies q))\implies q$
	имеем $p, (p\implies q)\vdash q$, значит из \ref{exproof:2} и
	\ref{exproof:3} можем вывести $B$ и $C$.\label{exproof:5}

	\item{}По \taut{} и тавтологии $(p\land q)\implies(p\land q)$ имеем
	$p,q\vdash p\land q$, значит из \ref{exproof:5} можем вывести $B\land C$.
	\label{exproof:6}

	\item{}Рассуждения \ref{exproof:1}-\ref{exproof:6} показывают
	$\ref{exproof:1},\ref{exproof:2}\to \ref{exproof:6}$, значит по правилу
	\implic{} $\ref{exproof:1}\vdash [\ref{exproof:2}\implies \ref{exproof:6}]$,
	тогда имеем $A\implies B\land C$.\label{exproof:7}

	\item{}Для краткости обозначим формулу
	$(A\implies B)\land (A\implies C)$ буквой $\alpha$,
	а $(A\implies B\land C)$ --- буквой $\beta$.
	Рассуждения \ref{exproof:1}-\ref{exproof:7} показывают $\alpha\to\beta$,
	а значит и $[\top,\alpha\to\beta]$, тогда по правилу \implic{}
	имеем $\top\vdash [\alpha\implies\beta]$.\qed
\end{enumerate}

Обычно доказательства формулируются более свободно,
но при непонимании некоторого доказательства имеет смысл попробовать
его записать в нормальном виде.

Эта теорема, как и многие другие является своебразным шаблоном теоремы,
потому что вместо $A$, $B$ и $C$ можно подставить любые формулы.

На данный момент понятие значения переменной играет малую роль в построении теории.
Оно нужно только для определения набора тавтологий для правила \taut{}.
\textsc{Проверка на тавтологию
	происходит вне формальной системы}, значит для неё понятие значения переменной
не нужно.

% Правила для произвольного
% символа $\lambda$ называются следующим образом: $\lambda$I --- {\it правило
% введения}, $\lambda$E --- {\it правило исключения (использования)}\footnote{
%   I --- Introduction, введение.
% 
%   E --- Elimination, исключение.
% }. $\top$ можно определить как $\lnot\bot$.

Система полностью абстрагирована от понятия значения переменной.
Все правила являются просто операциями со строками, не зависящими от смысла
этих строк. Это позволяет нам более свободно и интуитивно интерпретировать, то
есть придавать смысл этим строкам.
Нам предстоит ввести правила для $=$, $\forall$ и $\exists$.

Но для начала докажем два занимательных факта:

\begin{enumerate}
	\item{}
	Пусть $T(\Px)$, где $\Px$ --- совокупность из $m$ символов переменных,
	является простой тавтологией, тогда
	{\it Теорема:} Для произвольного набора из $m$ формул $\Sx$ справедливо $T(\Sx)$.

		{\it Доказательство:}
	$T(\Px)$ --- простая тавтология, значит и
	${\top\implies T(\Px)}$ --- простая тавтология. Тогда по правилу \taut{} имеем
	$\top\vdash T(\Sx)$.\qed

	\item{}Если $T$ --- теорема, то $S\to T$ для произвольной формулы $S$.

		{\it Доказательство:}
	Пусть теорема $T$ выводима из аксиом $A_1,...,A_{n}$.
	\begin{enumerate}[label=(\roman*)]
		\item{}\label{1p}Предположим произвольную формулу $S$.
		\item{}\label{2p}По \axiom{} из \ref{1p} можем вывести
		формулы $A_1,...,A_{n}$.
		\item{}\label{3p}$A_1,...,A_{n}\to T$, значит из \ref{2p} можем вывести $T$.\qed
	\end{enumerate}
\end{enumerate}

Если $S\to T$ или $S\vdash T$ для произвольной формулы $S$,
то пишут $\to T$ и $\vdash T$ соответственно. В таком случае,
в любое доказательство можно просто добавить формулу $T$,
не указывая, из какой формулы она выведена. Очевидно,
если $\to T$, то $T$ --- теорема. Для всякой аксиомы или теоремы $A$
справедливо $\to A$.

\section{Равенство}

Так как мы забыли понятие значения переменной,
нам придётся заново ввести понятие равенства\footnote{
	Точнее, мы введём правила, по которым можно манипулировать
	формулами с символом $=$.
}.

Для удобства введём понятие {\it рода выражения}. Когда мы начнём работать с числами
и множествами нам понадобится различать их от формул. Если $A$ --- формула,
то будем говорить, что род выражения $A$ --- формула. Если выражение из одного
символа имеет род, то этот символ называют {\it переменной}.

Например, числовой род выражения с операциями $+$ и $\cdot$
можно ввести следующим образом:
\begin{enumerate}
	\item{}Род выражений $1$, $2$, ... --- число.
	\item{}Если $a$ и $b$ --- числа\footnote{Их род --- число,
		сами они являются переменными.}, то
	$a+b$ и $a\cdot b$ --- числа.
\end{enumerate}

Введём в алфавит символ $=$ и расширим понятие формулы: если $A$ и $B$ --- выражения
одного рода, то $A=B$ --- формула.

Основное свойство равенства в том, что если два выражения равны, то их можно
заменять друг другом в формулах. Это можно ввести в правиле $=$E:
\[
	P(A),A=B\vdash P(B),
\]

где $A$, $B$ --- такие произвольные выражения, что $P(A)$, $P(B)$, $A=B$ --- формулы.

Выражение равно самому себе. Введём это в правиле $=$I:
\[
	\vdash V=V,
\]

где $V$ --- выражение, имеющее род.

Введём понятие равенства для формул следующей аксиомой:
\[
	[(A\implies B)\land (B\implies A)]\implies A=B,
\]

где $A$ и $B$ --- формулы.

\textsc{Обычно понятие равенства для различных родов выражений
	вводится через такие аксиомы.}
Например для векторов равенство вводится следующей аксиомой:
\[
	\big[\vec{a}\upuparrows\vec{b}\land|\vec{a}|=|\vec{b}|\big]
	\implies \vec{a}=\vec{b}
\]

{\it Теорема:} Пусть $A$ --- формула, тогда $A=\lnot\lnot A$.

	{\it Доказательство:}
\begin{enumerate}[label=(\arabic*)]
	\item{}По рассуждениям выше о тавтологиях и теоремах
	имеем\footnote{Выражение является тавтологией, значит является теоремой,
		значит выводимо из произвольной формулы.}
	\[
		(A\implies \lnot\lnot A)\land (\lnot\lnot A\implies A)
	\]
	\label{exproof:2}

	\item{}По \axiom{} имеем
	\label{exproof:3}
	\[
		[(A\implies \lnot\lnot A)\land (\lnot\lnot A\implies A)]\implies A=\lnot\lnot A
	\]
	\item{}${p,[p\implies r]\vdash r}$ по \taut{},
	из \ref{exproof:2} и \ref{exproof:3}
	можем вывести $A=\lnot\lnot A$.\qed
\end{enumerate}

Подразумевается первая строка ``предположим $\top$'', потому что для доказательства
$T$ нужно показать $\top\to T$. Также формула в \ref{exproof:1} должна быть выведена
из какой-то произвольной формулы. Далее эта первая строка тоже будет опускаться.

\textsc{Понятия выводимости из ниоткуда не существует,
	самое близкое к нему --- выводимость из произвольной формулы.}

\section{Кванторы}

\newcommand\Aii{$\forall$I}
\newcommand\Aee{$\forall$E}
\newcommand\Eii{$\exists$I}
\newcommand\Eee{$\exists$E}

Введём в алфавит символы $\forall$ и $\exists$ и расширим понятие формулы:
пусть $A$ --- формула, а $\gamma$ --- произвольный символ переменной,
тогда $(\forall\gamma)A$ и $\exists\gamma:A$ --- формулы.

Начнём с квантора всеобщности. $(\forall x)P(x)$ означает, что $P(x)$ для
всякого $x$, значит оно доказуемо для каждого $x$. Это можно запечатлить
в правилах
\begin{enumerate}
	\item[(\Aii{})]{}$\Gamma\vdash(\forall x)P(x)$, если $\Gamma\to P(t)$ и $t$
	не свободна\footnote{
		Как и в первой главе, переменная $t$ {\it связанна} в формуле $F$,
		если $F$ содержит
		выражение $Kt$, где $K$ --- квантор. Если $F$ содержит $t$ и $t$ не связанна
		в $F$, то $t$ {\it свободна} в $F$.
	} ни в одной из формул в совокупности $\Gamma$.

	\item[(\Aee{})]{}$(\forall x)P(x)\vdash P(t)$, где $t$ и $x$
	имеют один род.\footnote{
		Обычно род связанных переменных напрямую не указывается, а подразумевается,
		что он должен быть таким, чтобы выражение $(\forall x)P(x)$ было формулой.
	}.
\end{enumerate}

Для квантора существования вводятся следующие правила:
\[
	(\exists\text{I})~ P(t)\vdash [\exists x:P(x)]\qquad
	(\exists\text{E})~ [\exists x:P(x)],[(\forall x)(P(x)\implies C)]\vdash C
\]

Заметим, что при введении правил для равенства и кванторов мы
сначала выбираем, какой смысл мы придаём обозначениям, а потом вводим
правила для формализации этого смысла.
\textsc{С помощью правил мы формализуем смысл, придаваемый обозначениям.}

В качестве примера докажем в нормальном виде один из законов отрицания кванторов.

{\it Теорема:} $\lnot [\exists x:P(x)]\implies  (\forall x)\lnot P(x)$

{\it Доказательство:}
\begin{enumerate}[label=(\arabic*)]
	\item{}\label{1}Предположим $\lnot [\exists x:P(x)]$.
	\item{}\label{2}Введём переменную $t$.
	\item{}\label{3}Предположим $P(t)$.
	\item{}\label{4}По \Eii{}, \ref{3} имеем $\exists x:P(x)$.
	\item{}\label{5}По \implic{}, \ref{3}-\ref{4} имеем $P(t)\implies \exists x:P(x)$.
	\item{}\label{6}${[p\implies q],\lnot q\vdash \lnot p}$ по \taut{}, из
	\ref{1} и \ref{5} можем вывести $\lnot P(t)$.
	\item{}\label{7}Рассуждения \ref{2}-\ref{6} показывают
	$\lnot[\exists x:P(x)]\to\lnot P(t)$, значит по \Aii{} из \ref{1} можем
	вывести $(\forall x)\lnot P(x)$.\qed
\end{enumerate}

{\it Упражнения:}
\begin{enumerate}
	\item{}Обосновать правила вывода для квантора существования.
	\item{}Доказать теоремы:
	\begin{enumerate}
		\item{}$[(\forall x)P(x)]\land[(\forall x)(P(x)\implies Q(x))]
			\implies (\forall x)Q(x)$\label{thm:obv_forall}
		\item{}$(\forall x)T(P(x))$, где $T(p)$ --- простая тавтология.\label{thm:obv_taut}
		\item{}$(\forall x)T(P_1(x),...,P_{n}(x))$, где $T(p_1,...,p_{n})$ ---
		простая тавтология.
	\end{enumerate}
	\item{}*Доказать в нормальном виде остальные законы отрицания кванторов.
\end{enumerate}

\section{Цепочки импликаций}

Они позволяют нам привести доказательства выше к доказательствам в виде
{\it цепочек импликаций}. Такие доказательства основаны на тавтологии
\[
	[(p\implies q)\land(q\implies r)]\implies [p\implies r],
\]

а шаги в построении цепочки подразумевают использование правила \implic{}.
Знак импликации заменяет собой знак выводимости.

{\it Теорема:} $\lnot[\exists x:P(x)]\implies (\forall x)\lnot P(x)$

{\it Доказательство:}

Пусть\footnote{
	``Пусть'' --- синоним слова предположим. Некоторые авторы также
	используют значок $\sqsupset$.
} $\lnot[\exists x:P(x)]$. Возьмём произвольное $t$.
\[
	P(t)\xRightarrow{\text{$\exists$I}} \exists x:P(x)
	\xRightarrow{p,\lnot p\vdash\bot} \bot
\]

Тогда $\lnot P(t)$ и $(\forall x)\lnot P(x)$
по $\forall$I.\qed

{\it Теорема:} $\lnot[(\forall x)P(x)]\implies \exists x:\lnot P(x)$

{\it Доказательство:}

Пусть $\lnot[(\forall x)P(x)]$.
\[
	\lnot[\exists x:\lnot P(x)]\implies (\forall x)\lnot\lnot P(x)
	\xRightarrow{\lnot\lnot q\implies q} (\forall x)P(x)\implies\bot
\]

Тогда $\exists x:\lnot P(x)$.\qed

{\it Теорема:} $(\forall x)\lnot P(x)\implies \lnot[\exists x:P(x)]$

{\it Доказательство:}

Пусть $(\forall x)\lnot P(x)$. Возьмём произвольное $t$. $\lnot P(t)$ по $\forall$E.
\[
	P(t)\implies \bot
\]

Тогда $(\forall x)(P(x)\implies \bot)$.
\[
	\exists x:P(x)\xRightarrow{\text{$\exists$E}} \bot
\]

Тогда $\lnot[\exists x:P(x)]$.\qed

{\it Теорема:} $\exists x:\lnot P(x)\implies\lnot[(\forall x)P(x)]$

{\it Доказательство:}

Пусть $\exists x:\lnot P(x)$. Возьмём произвольное $t$. Пусть $\lnot P(t)$.
\[
	(\forall x)P(x)\implies P(t)\implies \bot
\]

Тогда ${\lnot P(t)\implies \lnot[(\forall x)P(x)]}$ и по $\forall$I, $\exists$E
имеем $\lnot[(\forall x)P(x)]$.\qed

Цепочки импликаций также можно называть ``человеческим видом'', потому что они более
понятны при чтении.

В человеческом виде часто используются следующие обороты:
\begin{enumerate}
	\item{}
	Пусть $A$.

	$A\implies ...\implies B$

	Тогда $B$.
	\item{}
	Пусть $A$.

	$B\implies ...\implies \bot$ или $B\implies ...\implies \lnot A\implies\bot$

	Тогда $\lnot B$.
\end{enumerate}

{\it Упражнения:}
\begin{enumerate}
	\item{}Обосновать каждую импликацию в доказательствах законов отрицания кванторов.
\end{enumerate}

\pagebreak
