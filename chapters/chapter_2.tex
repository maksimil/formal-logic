\part{Вывод теорем}

\section{Формальная система}

Совокупность правил называется {\it формальной системой}, если выполняются следующие
условия:
\begin{enumerate}
	\item{}Задан {\it алфавит} для составления {\it выражений}.
	\item{}Определено понятия {\it формулы}.
	\item{}Задана совокупность формул, называемых {\it аксиомами}.
	\item{}Заданы {\it правила вывода} одних формул из других.
\end{enumerate}

Если формула $T$ выводима из формул $A_1,A_2,...,A_{n}$ за один шаг (одно применение
правил вывода), то пишут $A_1,A_2,...,A_{n}\vdash T$.

Порядок формул слева не имеет значения и могут быть и излишние формулы:
если $A,B\vdash T$, то $B,A\vdash T$ и $B,A,C\vdash T$.

\newcommand\Sx{\mathcal S}
Возьмём совокупность формул $\Sx$. Пусть
\[
	\Sx\vdash A_1\qquad
	\Sx,A_1\vdash A_2\qquad...\qquad
	\Sx,A_1,A_2,...,A_{n-1}\vdash A_{n}
\]

Тогда пишут $\Sx\to A_{n}$ и говорят, что $A_{n}$ {\it доказуемо} из $\Sx$\footnote{
	$A\vdash B$ подразумевает $A\to B$.
}.
Рассуждения, показывающие доказуемость называются {\it доказательством}.
Если $\Sx$~---~совокупность аксиом и $\Sx\to T$, то $T$ называют
{\it теоремой}. Очевидно, порядок формул слева не имеет значения и могут быть
излишние формулы.

\newcommand\ruleR{\mathbf{R}}
\newcommand\ruleC{\mathbf{C}}

Рассмотрим следующий пример формальной системы:
\begin{enumerate}
	\item{}Алфавит: $a$, $b$, $c$.
	\item{}Всякое непустое выражение является формулой.
	\item{}Аксиомы: $aab$, $c$.
	\item{}Правила вывода:
	\begin{enumerate}
		\item[($\ruleR$)]{}$A\vdash A'$, если $A'$ можно получить из $A$,
		убрав один символ\footnote{Тогда $aab\vdash ab$ и $ab\vdash b$.}.
		\item[($\ruleC$)]{}$A,B\vdash AB$, если у формул $A$ и $B$ нет
		общих символов\footnote{Тогда $b,c\vdash bc$ и $ac,bb\vdash acbb$.}.
	\end{enumerate}
\end{enumerate}

{\it Теорема:} $abc$

{\it Доказательство:}
$aab\vdash ab$ по правилу $\ruleR$, значит $aab,c\vdash ab$.
$ab,c\vdash abc$ по правилу $\ruleC$, значит $aab,c,ab\vdash abc$.
Тогда $aab,c\to abc$ и $abc$ --- теорема, потому что $aab$ и $c$ --- аксиомы.
\qed\footnote{$\qed$ означает ``что и требовалось доказать''.}

Доказуемость можно показать и с помощью рассуждений в {\it нормальном виде}:
Для доказательства $\Sx\to T$ можно предположить формулы из $\Sx$ и последовательно
увеличивать список выведенных формул, пока не дойдём до $T$.

\pagebreak

Доказательство $abc$ в нормальном виде:
\begin{enumerate}[label=(\arabic*)]
	\item{}\label{1}Предположим $aab$.
	\item{}\label{2}Предположим $c$.
	\item{}\label{3}$ab$ по $\ruleR$, \ref{1}.
	\item{}\label{4}$abc$ по $\ruleC$, \ref{2}, \ref{3}.
\end{enumerate}

Тогда $aab,c\to abc$.\qed

\textsc{формальная система является просто набором правил и её формулы
	могут не иметь смысла. Они и не будут иметь смысла, пока мы не начнём их
	интерпретировать, то есть придавать им этот смысл.}

В общем случае формальные системы не обращаются с понятиями ``истины'' и ``лжи'',
они обращаются с понятиями ``выводимости''. Но для удобства определим формулу
как {\it истинную}, если она является аксиомой или теоремой\footnote{
	Истинность в формальной системе исходит из
	определения этой формальной системы,
	поэтому истинные формулы принято называть тавтологиями.
}.

Важно понимать связь между понятием истины в формальных системах
и эмпиричной истины\footnote{Эмпиризм --- метод познания через ощущение (наблюдение).}.
Физики подбирают аксиомы (постулаты),
из которых выводимы теоремы (законы), соответствующие наблюдениям.
Они подгоняют истину формальной системы к эмпиричной истине.

Математики же
в большинстве областей подгоняют формальную систему так,
чтобы она соответствовала интуитивной логике,
что не всегда получается: понятие ``импликации'' в математике не совпадает
с понятием ``следствия'' интуитивной логики. Следствие
нередко подразумевает причинно-следственную
связь, импликация же такой связи не подразумевает (например, ${p\implies(q\implies p)}$).

\section{Правила вывода}

Сформулируем формальную систему, в которой мы будем работать.
Алфавит будет состоять из букв различиных человеческих языков, знаков $\top$,
$\bot$, а также $\lnot$, $\land$, $\lor$, $\implies$, $\iff$. Кванторы и равенство пока
что вводить не будем.

Для определения понятия формулы будем использовать понятие рода из первой главы,
не используя понятие значения.
Введём следующие правила определения рода:
\begin{enumerate}
	\item{}Род выражений $\top$ и $\bot$ --- формула.
	\item{}Если род выражений $A$ и $B$ --- формула, то выражения
	\[
		\lnot A\qquad A\land B\qquad A\lor B\qquad A\implies B\qquad A\iff B
	\]
	тоже являются формулами.
\end{enumerate}

Возьмём $\top$ как аксиому и введём правила вывода:

\newcommand\taut{$\mathcal T$}
\newcommand\axiom{$\mathcal A$}
\newcommand\conj{$\mathcal C$}
\newcommand\implic{$\mathcal I$}
\newcommand\Px{\mathcal P}
\begin{enumerate}
	\item[(\axiom)]{}$S\vdash A$, где $A$ --- аксиома, $S$ --- любая формула.

	\item[(\taut)]{}$F_1(\Px/\Sx),...,F_n(\Px/\Sx)\vdash T(\Px/\Sx)$,
	если ${F_1\land...\land F_n\implies T}$ --- простая тавтология, где
	$\Px$ --- совокупность из всех символов переменных тавтологии,
	$\Sx$ --- совокупность формул, причём каждому символу из $\Px$
	поставлена в соотвествие единственная формула из $\Sx$\footnote{
		Например, возьмём простую тавтологию
		\[
			(p\land (p\implies q))\implies q
		\]

		Обозначим выражение $p$ как $F_1$, $p\implies q$ --- $F_2$,
		а $q$ --- $T$.

		Совокупность $\Px$ содержит $p$ и $q$.
		Совокупность $\Sx$ содержит произвольные формулы $A$ и $B$.
		По \taut{} имеем правило
		\[
			A,[A\implies B]\vdash B
		\]
		для произвольных формул $A$ и $B$.

		Исходя из той же тавтологии также имеем правило
		\[
			A\land[A\implies B]\vdash B
		\]
		для произвольных формул $A$ и $B$.
	}.

	\item[(\implic)]{}${\Gamma\vdash (S\implies T)}$, если $[\Gamma,S\to T]$, где $\Gamma$
	--- совокупность формул.
\end{enumerate}

Правило \axiom{} позволяет проще использовать аксиомы в рассуждениях.
\taut{} позволяет использовать простые тавтологии (законы логики) в рассуждениях.
\implic{} позволяет выводить импликацию.

Три ``стрелочки'' имеют схожие значения:
\begin{enumerate}
	\item{}$\vdash$ означает выводимость за один шаг.
	\item{}$\to$ означает существование доказательства.
	\item{}$\implies$ --- знак из алфавита формальной системы.
\end{enumerate}

Рассмотрим пример доказательства.

{\it Теорема:} Для формул $A$, $B$ и $C$ справедливо\footnote[][3mm]{
	Уточнение, что $A$, $B$, $C$ --- формулы необходимо, чтобы выражение, которое
	нужно доказать было формулой.

	``Справедливо'' означает ``истинно'', то есть доказуемо из аксиом.
}
\[
	[(A\implies B)\land (A\implies C)]\implies (A\implies B\land C)
\]

{\it Доказательство:}

Для краткости обозначим формулу
$(A\implies B)\land (A\implies C)$ буквой $\alpha$,
а $(A\implies B\land C)$ --- буквой $\beta$.

\begin{enumerate}[label=(\arabic*)]
	\item{}\label{1}Предположим $\alpha$.

	\item{}\label{2}Предположим $A$.

	\item{}\label{3}По \taut{} и тавтологии $(p\land q)\implies p$ имеем
	$p\land q\vdash p$, значит из \ref{1} можем вывести
	$A\implies B$ и, аналогично, $A\implies C$.

	\item{}\label{4}По \taut{} и тавтологии ${(p\land (p\implies q))\implies q}$
	из \ref{2} и \ref{3} можем вывести $B$ и $C$.

	\item{}\label{5}По тавтологии $(p\land q)\implies(p\land q)$
	из \ref{4} можем вывести $B\land C$.

	\item{}\label{6}Рассуждения \ref{1}-\ref{5} показывают
	$\alpha,A\to B\land C$, значит $\alpha\vdash \beta$ по \implic{},
	тогда из \ref{1} можем вывести $\beta$.

	\item{}\label{7}
	Рассуждения \ref{1}-\ref{7} показывают $\alpha\to\beta$,
	а значит и $\top,\alpha\to\beta$, тогда по \implic{}
	имеем $\top\vdash [\alpha\implies\beta]$.\qed
\end{enumerate}

Эту теорему скорее можно назвать {\it схемой теорем}, потому что она представляет
собой по теореме для каждых возможных формул $A$, $B$ и $C$.

На данный момент, понятие значения переменной играет малую роль в построении теории.
Оно нужно только для определения набора простых тавтологий для правила \taut{}.
\textsc{Проверка на простую тавтологию
	происходит вне формальной системы}, значит для неё понятие значения не нужно.

Система полностью абстрагирована от понятия значения переменной.
Все правила являются просто операциями со строками, не зависящими от смысла
этих строк. Это позволяет нам более свободно и интуитивно интерпретировать, то
есть придавать смысл этим строкам.
Нам предстоит ввести правила для $=$, $\forall$ и $\exists$.

Но для начала докажем два занимательных факта:

\begin{enumerate}
	\item{}{\it Теорема:}
	Если $T$ --- простая тавтология, то
	для произвольного набора формул $\Sx$ справедливо $T(\Px/\Sx)$
	($\Px$ и $\Sx$ определены как в правиле \taut{}).

		{\it Доказательство:}
	$T$ --- простая тавтология, значит и
	${\top\implies T}$ --- простая тавтология. Тогда по правилу \taut{} имеем
	$\top\vdash T(\Px/\Sx)$.\qed

	\item{}Если $T$ --- теорема, то $S\to T$ для произвольной формулы $S$.

		{\it Доказательство:}
	Пусть теорема $T$ выводима из аксиом $A_1,...,A_{n}$.
	\begin{enumerate}[label=(\roman*)]
		\item{}\label{1p}Предположим произвольную формулу $S$.
		\item{}\label{2p}По \axiom{} из \ref{1p} можем вывести
		формулы $A_1,...,A_{n}$.
		\item{}\label{3p}$A_1,...,A_{n}\to T$, значит из \ref{2p} можем вывести $T$.\qed
	\end{enumerate}
\end{enumerate}

Если $S\to T$ или $S\vdash T$ для произвольной формулы $S$,
то пишут $\to T$ и $\vdash T$ соответственно. В таком случае,
в любое доказательство можно просто добавить формулу $T$,
не указывая, из какой формулы она выведена. Очевидно,
если $\to T$, то $T$ --- теорема. Для всякой аксиомы или теоремы $A$
справедливо $\to A$.

\section{Равенство}

Так как мы забыли понятие значения переменной,
нам придётся заново ввести понятие равенства\footnote{
	Точнее, мы введём правила, по которым можно манипулировать
	формулами с знаком $=$.
}.

Введём в алфавит знак $=$ и расширим понятие формулы: если $A$ и $B$ --- выражения,
имеющие род, то $A=B$ --- формула.

Новый знак можно ввести набором из двух правил:
$\lambda$I\footnote{I --- Introduction, введение} --- {\it правило введения}
и $\lambda$E\footnote{E --- Elimination, исключение} --- {\it правило
исключения (использования)}, где $\lambda$ --- знак, который мы хотим ввести.

\pagebreak

Основное свойство равенства в том, что если два выражения равны, то их можно
заменять друг другом в формулах. Это можно ввести в правиле $=$E:
\[
	P,[A=B]\vdash P(A/B),
\]
где $A$, $B$ --- такие выражения, что $P$, $P(A/B)$, $A=B$ --- формулы.

Выражение равно самому себе. Введём это в правиле $=$I:
\[
	\vdash V=V,
\]
где $V$ --- выражение, имеющее род.

{\it Теорема:} Пусть $A$, $B$, $P$ и $P(A/B)$ --- выражения, имеющие род,
тогда справедливо следующее
\[
	A=B\implies P=P(A/B)
\]

{\it Доказательство:}
\begin{enumerate}[label=(\arabic*)]
	\item{}\label{1}Предположим $\top$.
	\item{}\label{2}Предположим $A=B$.
	\item{}\label{3}По $=$I из \ref{1} можем вывести $P=P$.
	\item{}\label{4}По $=$E из \ref{2} и \ref{3} можем вывести $P=P(A/B)$.
	\item{}\label{5}Рассуждения \ref{1}-\ref{4} показывают $\top,A=B\to P=P(A/B)$,
	значит по \implic{} имеем $\top\vdash [A=B\implies P=P(A/B)]$.\qed
\end{enumerate}

Первая строка необходима, потому что для доказательства
$T$ нужно показать $\top\to T$. Также из неё удобно выводить формулы,
выводимые из произвольных формул. Далее она будет опускаться,
но подразумеваться.
\textsc{Понятия выводимости из ниоткуда не существует,
	самое близкое к нему --- выводимость из произвольной формулы.}

Введём понятие равенства\footnote{
	\textsc{Обычно понятие равенства для различных родов выражений
		вводится через такие аксиомы.}
	Например для векторов равенство вводится следующей аксиомой:
	\[
		\big[\vec{a}\upuparrows\vec{b}\land|\vec{a}|=|\vec{b}|\big]
		\implies \vec{a}=\vec{b}
	\]
} для формул следующей аксиомой:
\[
	(A\iff B)\implies A=B,
\]
где $A$ и $B$ --- формулы\footnote{
Эту аксиому скорее можно назвать {\it схемой аксиом}, потому что она представляет
собой по аксиоме для каждых возмножных формул $A$ и $B$.
}.

{\it Теорема:} Пусть $A$ --- формула, тогда $A=\lnot\lnot A$.

	{\it Доказательство:}
\begin{enumerate}[label=(\arabic*)]
	\item{}\label{1}По рассуждениям выше о тавтологиях и теоремах
	имеем\footnote{Выражение является тавтологией, значит является теоремой,
		значит выводимо из произвольной формулы.}
	\[
		A\iff\lnot\lnot A
	\]

	\item{}\label{2}По \axiom{} имеем
	\[
		(A\iff \lnot\lnot A)\implies A=\lnot\lnot A
	\]
	\item{}\label{3}${p,[p\implies r]\vdash r}$ по \taut{},
	из \ref{1} и \ref{2}
	можем вывести $A=\lnot\lnot A$.\qed
\end{enumerate}


\section{Кванторы}

\newcommand\Aii{$\forall$I}
\newcommand\Aee{$\forall$E}
\newcommand\Eii{$\exists$I}
\newcommand\Eee{$\exists$E}

Введём в алфавит знаки $\forall$ и $\exists$ и расширим понятие формулы:
пусть $A$ --- формула о $\gamma$,
тогда $(\forall\gamma)A$ и $\exists\gamma:A$ --- формулы.

Начнём введение правил с квантора всеобщности. $(\forall x)P$ означает, что $P$ для
всякого $x$, значит оно доказуемо для каждого $x$. Это можно запечатлить
в правилах
\begin{enumerate}
	\item[(\Aii{})]{}$\Gamma\vdash(\forall x)P(t/_{a}x)$, если $\Gamma\to P$ и $t$
	не связанна в $P$ и
	не свободна ни в одной из формул в совокупности $\Gamma$.

	\item[(\Aee{})]{}$(\forall x)P\vdash P(x/_{a}t)$, где $t$ и $x$
	имеют один род\footnote{
		Обычно род связанных переменных напрямую не указывается, а подразумевается,
		что он должен быть таким, чтобы выражение $(\forall x)P$ было формулой.
	}.
\end{enumerate}

Для квантора существования вводятся следующие правила:
\begin{enumerate}
	\item[(\Eii{})]$P\vdash [\exists x:P(t/x)]$, где $P$ --- формула о $t$.
	\item[(\Eee{})]$[\exists x:P],[(\forall x)(P\implies C)]\vdash C$,
	где $x$ не свободна в $C$.
\end{enumerate}

Заметим, что при введении правил для равенства и кванторов мы
сначала выбираем, какой смысл мы придаём обозначениям, а потом вводим
правила для формализации этого смысла.
\textsc{С помощью правил мы формализуем смысл, придаваемый обозначениям.}

В качестве примера докажем в нормальном виде один из законов отрицания кванторов.

{\it Теорема:} $\lnot [\exists x:P]\implies  (\forall x)\lnot P$

{\it Доказательство:}
\begin{enumerate}[label=(\arabic*)]
	\item{}\label{1}Предположим $\lnot [\exists x:P]$.
	\item{}\label{2}Введём переменную $t$, предполагая, что $P$ не содержит $t$.
	\item{}\label{3}Предположим $P(x/_{a}t)$.
	\item{}\label{4}По \Eii{}, \ref{3} имеем $\exists x:P$.
	\item{}\label{5}По \implic{}, \ref{3}-\ref{4} имеем
	$P(x/_{a}t)\implies \exists x:P$.
	\item{}\label{6}${[p\implies q],\lnot q\vdash \lnot p}$ по \taut{}, из
	\ref{1} и \ref{5} можем вывести $\lnot P(x/_{a}t)$.
	\item{}\label{7}Рассуждения \ref{1}-\ref{6} показывают
	$\lnot[\exists x:P]\to\lnot P(x/_{a}t)$, значит по \Aii{} из \ref{1} можем
	вывести $(\forall x)\lnot P$.\qed
\end{enumerate}

{\it Упражнения:}
\begin{enumerate}
	\item{}Обосновать правила \Eii{} и \Eee{}.
	\item{}Обосновать ограничения на связанность и свободу переменных в правилах
	\Aii{}, \Aee{}, \Eii{} и \Eee{}.
	\pagebreak
	\item{}\label{ex:obv_thm}Доказать теоремы:
	\begin{fullwidth}
		\begin{multicols}{2}
			\begin{enumerate}
				\item{}$(\forall a)\exists b:a=b$
				\item{}$[(\forall x)P]\land[(\forall x)(P\implies Q)]
					\implies [(\forall x)Q]$\label{thm:obv_forall}
				\item{}$[\exists x:P]\land[(\forall x)(P\implies Q)]
					\implies [\exists x:Q]$
				\item{}$(\forall x)T(p/x)$, где $T$ --- простая тавтология,
				в которой $p$ --- единственная переменная.
				\item{}$(\forall x)T(\Px/\Sx)$, где $T$ --- простая тавтология,
				$\Sx$ --- формулы о $x$.\label{thm:obv_taut}
			\end{enumerate}
		\end{multicols}
	\end{fullwidth}
	\item{}*Доказать в нормальном виде остальные законы отрицания кванторов.
\end{enumerate}

\section{Цепочки импликаций}

Часто доказательства в математике записываются в виде {\it цепочек импликаций}.
Цепочка $A_1\implies A_2\implies...\implies A_{n}$ означает, что $A_1\implies A_2$,
$A_2\implies A_3$, ... и $A_{n-1}\implies A_{n}$.
Построение такой цепочки доказывает $A_1\implies A_{n}$.

Цепочки импликаций также можно называть ``человеческим видом'', потому что они более
понятны при чтении.

В человеческом виде часто используются следующие обороты
для доказательства $A\implies B$:
\begin{enumerate}
	\item{}
	Пусть $A$.

	$A\implies ...\implies B$

	Тогда $B$.
	\item{}
	Пусть $A$.

	$\lnot B\implies ...\implies \bot$
	(или $\lnot B\implies ...\implies \lnot A\implies\bot$)

	Тогда $B$.
\end{enumerate}

{\it Теорема:} $\lnot[\exists x:P]\implies (\forall x)\lnot P$

{\it Доказательство:}

Пусть\footnote{
	``Пусть'' --- синоним слова предположим. Некоторые авторы также
	используют значок $\sqsupset$.
} $\lnot[\exists x:P]$. Возьмём произвольное $t$. Это следующие доказательства
предполагают, что $P$ не содержит $t$.
\[
	P(x/_{a}t)\xRightarrow{\text{$\exists$I}} \exists x:P
	\xRightarrow{p,\lnot p\vdash\bot} \bot
\]

Тогда $\lnot P(x/_{a}t)$ и $(\forall x)\lnot P$
по $\forall$I.\qed

{\it Теорема:} $\lnot[(\forall x)P]\implies \exists x:\lnot P$

{\it Доказательство:}

Пусть $\lnot[(\forall x)P]$.
\[
	\lnot[\exists x:\lnot P]\implies (\forall x)\lnot\lnot P
	\xRightarrow{\lnot\lnot q\implies q} (\forall x)P\implies\bot
\]

Тогда $\exists x:\lnot P$.\qed

\pagebreak

{\it Теорема:} $(\forall x)\lnot P\implies \lnot[\exists x:P]$

{\it Доказательство:}

Пусть $(\forall x)\lnot P$. Возьмём произвольное $t$. $\lnot P(x/_{a}t)$ по $\forall$E.
\[
	P(x/_{a}t)\implies \bot
\]

Тогда $(\forall x)(P\implies \bot)$.
\[
	\exists x:P\xRightarrow{\text{$\exists$E}} \bot
\]

Тогда $\lnot[\exists x:P]$.\qed

{\it Теорема:} $\exists x:\lnot P\implies\lnot[(\forall x)P]$

{\it Доказательство:}

Пусть $\exists x:\lnot P$. Возьмём произвольное $t$. Пусть $\lnot P(x/_{a}t)$.
\[
	(\forall x)P\implies P(x/_{a}t)\implies \bot
\]

Тогда ${\lnot P(x/_{a}t)\implies \lnot[(\forall x)P]}$ и по $\forall$I, $\exists$E
имеем $\lnot[(\forall x)P]$.\qed

{\it Упражнения:}
\begin{enumerate}
	\item{}Почему построение цепочки $A_1\implies...\implies A_{n}$
	доказывает $A_1\implies A_{n}$?
	\item{}Обосновать каждую импликацию в доказательствах законов отрицания кванторов.
\end{enumerate}

\pagebreak
